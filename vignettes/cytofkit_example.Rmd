---
title: "**cytofkit**: Quick Start"
output:
  BiocStyle::html_document:
    toc: true
---
<!--
%% \VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{BiocCheck}
-->


# Install and Load the Package


To install **cytofkit** pacakge, start R and run the following codes on R console:

```{r, eval=FALSE}
source("https://bioconductor.org/biocLite.R")
biocLite("cytofkit")
```

`Notes`: **cytofkit** GUI is dependent on XQuartz windowing system (X Windows) on Mac (OS X > 10.7). Install XQuartz from http://xquartz.macosforge.org.

* Download the disk image (dmg) file for [XQuartz](https://dl.bintray.com/xquartz/downloads/XQuartz-2.7.9.dmg).
* Double-clicking on the file to start the installation, you can do it safely by clicking through all the defaults.
* After the installer runs, you'll have to log out and back on to your Mac OS X account.

Load the Package:

```{r, message=FALSE}
library("cytofkit") 
```

Read the package description:

```{r, eval=FALSE}
?cytofkit-package
```


# Options for Using **cytofkit** Package

**cytofkit** provides three ways to employ the workforce of this package:

## Run with GUI 

The easiest way to use **cytofkit** package is through the GUI. The GUI provides all main options of **cytofkit** on an visual interface. To launch the GUI, load the package and type the following command:

```{r, eval=FALSE}
cytofkit_GUI()  
```

The interface will appear like below, you can click the information button **!** to check the explanation for each entry and customize your own analysis.

<u>On Windows:</u>       

![cytofkit GUI](cytofkit_GUI_windows.png)

<u>On Mac:</u>     

![cytofkit GUI](cytofkit_GUI_mac.png)
               
Start your analysis as simply as following:   

- Choose the input fcs files from the directory where you store FCS data; 
- Select the markers from the auto-generated marker list; 
- Choose the directory where to save your output; 
- Give a project name as a prefix for the names of result files; 
- Select a data merging method if you have multiple FCS files;
- Select your clustering method(s), visualization method(s), progression estimation method(s)

Then submit it, that's all. 

Depends on the size of your data, it will take some time to run the analysis. Once done, a window will pop up, showing you the path where the results have been stored, and asking you if to open the shiny web APP. If YES, the shiny APP will be deployed locally and opened in your default web browser. Among the saved results, a special R data object with suffix of *.RData* is for loading the results into the shiny APP. Choose the *.RData* file on the shiny APP then submit it, your journey of exploring the reulsts starts.

## Run with the Core Function 

**Cytofkit** provides a core function `cytofkit()` to drive the analysis pipeline of mass cytometry data. Users only need to define several key parameters to make their analysis automatically. One simple example of running cytofkit using the core function is like this:

```{r, eval=FALSE}
set.seed(100)
dir <- system.file('extdata',package='cytofkit')
file <- list.files(dir ,pattern='.fcs$', full=TRUE)
parameters <- list.files(dir, pattern='.txt$', full=TRUE)
res <- cytofkit(fcsFiles = file, 
                markers = parameters, 
                projectName = 'cytofkit_test',
                transformMethod = "cytofAsinh", 
                mergeMethod = "all",
                dimReductionMethod = "tsne",
                clusterMethods = c("Rphenograph", "ClusterX", "densVM"),  ## accept multiple methods
                visualizationMethods = c("tsne", "pca", "isomap"),        ## accept multiple methods
                progressionMethod = NULL,
                resultDir = getwd(),
                saveResults = FALSE, 
                saveObject = FALSE, 
                saveToFCS = FALSE)
```

You can customize the parameters for your own need, run `?cytofkit` to get information of all the parameters for `cytofkit`. As running with GUI, once the analysis is done, the results will be saved under `resultDir` automatically.
      

## Run with Commands (Step-by-Step) 

Due to the usually big size of the fcs data, we just use one small size file here as a demo, you can easily expand the analysis to multiple FCS files.

### Pre-processing

In each FCS file, 


### Cell Subset Detection


### Cell Subset Visualization and Interpretation 


### Inference of Subset Progression


### Post-processing
                        

